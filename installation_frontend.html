<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>PerfWatcher</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
	<link rel="icon" type="image/ico" href="images/perfwatcher.ico">
    <script src="javascripts/scale.fix.js"></script>
	<script type="text/javascript">
	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-31597873-1']);
	  _gaq.push(['_setDomainName', 'perfwatcher.org']);
	  _gaq.push(['_trackPageview']);
	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();
	</script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1><a href="index.html">PerfWatcher</a></h1>
        <p>Performance Monitoring based on Collectd</p>
        <p class="view"><a href="http://github.com/perfwatcher/perfwatcher">View the Project on GitHub <small>perfwatcher/perfwatcher</small></a></p>
        <ul>
          <li><a href="download.html">Quick<strong>Download</strong></a></li>
          <li><a href="http://github.com/perfwatcher/perfwatcher" target="_new">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>

<h3>Frontend installation</h3>
<p>
	Until Perfwatcher has package available, you need to grab source from GitHub.
</p>

<hr >

<h4>Prerequisites</h4>
	<ul>
		<li>PHP 5 (PHP 5.3 allows you to use php-rrd extention)</li>
		<li>MySQL Server &gt;= 4 or Postgresql Server &gt;= 8</li>
		<li>MySQL
		<ul>
			<li>PHP CLI
				<ul>
					<li>On Redhat like :<pre><code>yum install php php-cli php-gd httpd php-mysql php-pear php5-curl mysql-server mysql</code></pre></li>
					<li>On Debian like :<pre><code>aptitude install php5 apache php5-cli php5-gd php5-mysql php5-curl mysql-server mysql-client</code></pre></li>
					<li>On Suse like :<pre><code>zypper install apache2 apache2-mod_php5 mysql mysql-client php5-mysql php5 php5-pear php5-curl php5-gd</code></pre></li>
				</ul>
			</li>
			<li>MDB2 PEAR library for Mysql (check your umask - you may want to do <code>umask 0022</code> before installing MDB2 drivers)
				<ul>
					<li>On Redhat like :<pre><code>pear install MDB2_Driver_mysql</code></pre></li>
					<li>On Debian like :<pre><code>aptitude install php-mdb2-driver-mysql</code></pre></li>
					<li>On Suse like :<pre><code>pear install MDB2_Driver_mysql</code></pre></li>
				</ul>
			</li>
		</ul>
		</li>
		<li>Posgresql
		<ul>
			<li>PHP CLI
				<ul>
					<li>On Redhat like :<pre><code>yum install php php-cli php-gd httpd php-pgsql php-pear php5-curl postgresql-server postgresql</code></pre></li>
					<li>On Debian like :<pre><code>aptitude install php5 apache php5-cli php5-gd php5-pgsql php5-curl postgresql postgresql-client</code></pre></li>
					<li>On Suse like :<pre><code>zypper install apache2 apache2-mod_php5 postgresql-server postgresql-client php5-pgsql php5 php5-pear php5-curl php5-gd</code></pre></li>
				</ul>
			</li>
			<li>MDB2 PEAR library for Postgresql (check your umask - you may want to do <code>umask 0022</code> before installing MDB2 drivers)
				<ul>
					<li>On Redhat like :<pre><code>pear install MDB2_Driver_pgsql</code></pre></li>
					<li>On Debian like :<pre><code>aptitude install php-mdb2-driver-pgsql</code></pre></li>
					<li>On Suse like :<pre><code>pear install MDB2_Driver_pgsql</code></pre></li>
				</ul>
			</li>
		</ul>
		</li>
	</ul>

<hr >

<h4>Getting sources</h4>
<p>
	Two possibility :
	<ul>
		<li>Clone GitHub repo : <pre><code>git clone -b 'release/2.1' https://github.com/perfwatcher/perfwatcher.git</code></pre></li>
		<li>Download last stable version : <pre><code>wget http://perfwatcher.free.fr/download/perfwatcher/perfwatcher-2.1-20140326.tar.gz</code></pre></li>
	</ul>
</p>

<hr >

<h4>Installing sources</h4>
<p>
	<ul>
		<li>On RedHat like :
			<pre><code>cd /var/www/html</code></pre>
		</li>
		<li>On Debian like :
			<pre><code>cd /var/www</code></pre>
		</li>
		<li>On Suse like :
			<pre><code>cd /srv/www/htdocs</code></pre>
		</li>
	</ul>
	<pre><code>
tar xzf /&lt;your download directory&gt;/perfwatcher-2.1-20140326.tar.gz # If downloaded as tar.gz
 or
mv /&lt;your clone directory&gt;/perfwatcher . # If cloned from GitHub

cd perfwatcher
mkdir logs
</code></pre>
	<ul>
		<li>On RedHat like :
			<pre><code>chown -R apache:apache etc logs</code></pre>
		</li>
		<li>On Debian like :
			<pre><code>chown -R www-data:www-data etc logs</code></pre>
		</li>
		<li>On Suse like :
			<pre><code>chown -R wwwrun:www etc logs</code></pre>
		</li>
	</ul>
</p>

<hr >

<h4>Create MySQL database</h4>
<p>1/ Create the database (need admin permissions)</p>
<p><pre><code>CREATE DATABASE perfwatcher;</code></pre></p>

<p>2/ Create a user (and grants - need admin permissions)</p>

<p>Run one of those (check if you connect to localhost or to yourhostname with mysql) :
<p><pre><code>GRANT ALL PRIVILEGES ON perfwatcher.* TO 'perfwatcher'@'localhost' IDENTIFIED BY 'changeme';</code></pre></p>
<p><pre><code>GRANT ALL PRIVILEGES ON perfwatcher.* TO 'perfwatcher'@'yourhostname' IDENTIFIED BY 'changeme';</code></pre></p>

<p>3/ Create the database schema</p>

<p><pre><code>cat install/create.mysql | mysql -u perfwatcher -h localhost -p perfwatcher</code></pre></p>

<p>Note : If you upgrade from older version, please check for any script or README or UPGRADE file in the <code>install/</code> directory.</p>

<h4>Create Postgresql database</h4>
<p>1/ Check your pg_hba.conf file</p>
<p>Basic installation should contain a line like this :</p>
<p><pre><code># TYPE  DATABASE    USER        CIDR-ADDRESS          METHOD
[...]
local   all         all                               md5
</code></pre></p>

<p>2/ Create a user (and grants - need admin permissions)</p>

<p>Run this line (most linux users will need to use the postgres account)</p>
<p><pre><code># su - postgres
$ createuser --encrypted --no-inherit --login --pwprompt --no-createrole --no-superuser --no-createdb perfwatcher</code></pre></p>

<p>3/ Create the database</p>

<p>Run this line (most linux users will need to use the postgres account)</p>
<p><pre><code># su - postgres
$ createdb -e --encoding=UTF8 --owner=perfwatcher perfwatcher</code></pre></p>

<p>4/ Create the database schema</p>
<p><pre><code>cat install/create.pgsql | psql -W perfwatcher perfwatcher</code></pre></p>

<p>Note : If you upgrade from older version, please check for any script or README or UPGRADE file in the <code>install/</code> directory.</p>
<hr >

<h4>Configuring crontab</h4>
<p>Put this in your web server's user crontab:
<pre><code>* * * * * /&lt;path to perfwatcher&gt;/bin/peuplator
* * * * * /&lt;path to perfwatcher&gt;/bin/aggregator</code></pre>
</p>

<p>Note : you may want to customize those line, for example redirecting the stdout/stderr to some log file</p>
<p>Note : on large environments, those scripts may run in more than one minute. Run them every 2 or 5 minutes if this happens.</p>

<hr >

<h4>Configuring PerfWatcher</h4>
<p>
	<ul>
		<li>Copy the sample config file to config.php :<pre><code>cp etc/config.sample.php etc/config.php</code></pre></li>
		<li>Edit etc/config.php and follow the instructions</li>
	</ul>
</p>

<hr >

<h4>Check your configuration</h4>
<p>
	Go to http://&lt;your server&gt;/&lt;path to perfwatcher&gt;/setup.php
</p>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="http://github.com/feraudet">Cyril Feraudet</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="http://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><!--<![endif]-->
    
  </body>
</html>

